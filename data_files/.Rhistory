transcriptogramer::differentiallyExpressed()
load("/home/clovis/Dropbox/Chumbo/transcriptograms/allTranscriptogramers80")
transc[[1]]
View(transc)
View(transc)
transc[[1]]@DE
transc[[1]]@Terms
Terms(transc[[1]])
transcriptogramer::Terms(transc[[1]])
head(transcriptogramer::Terms(transc[[1]]))
t2<-transcriptogramer::Terms(transc[[2]])
View(t2)
t1<-transcriptogramer::Terms(transc[[1]])
View(t1)
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#           main processing
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#This script generate the figures in
# the same order than it apears in teh text
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#inicio ----
rm(list = ls())
baseDir="/home/clovis/Dropbox/Ecoli60/"
binDir=paste0(baseDir,"bin/")
workdir=paste0(baseDir,"data_files/")
figDir=paste0(baseDir,"figures/")
setwd(workdir)
setwd(binDir)
source(paste0(binDir,"allFunctions.R"))
setwd(workdir)
# deltaW<-readDeltaW(top,workdir)
# deltaW$dw<-NA
codonUsage<-read.csv("AuxFiles/dCodonUsage.csv",
header = T,
stringsAsFactors = F)
aminos<-read.csv("AuxFiles/dAminoCodon.csv",
header = T,
stringsAsFactors = F)
codonUsage<-merge(codonUsage[,c("ref","count")],
aminos,
by="ref")
tRNAe<-read.csv("TAIFiles/REL606tRNA.csv",
sep = "\t",
header = T,
stringsAsFactors = F)
tRNAe$ref<-apply(as.data.frame(tRNAe$AntiCodonsList),
MARGIN = 1,
convertToComplement)
codonUsage<-merge(codonUsage,tRNAe,by="ref")
tmp<-as.data.frame(unique(codonUsage$amino))
colnames(tmp)<-"amino"
tmp$max<-apply(tmp,MARGIN = 1,
FUN = function(x){
max(codonUsage$count[codonUsage$amino == x[1]])
})
tmp$min<-apply(as.data.frame(tmp[,1]),MARGIN = 1,
FUN = function(x){
min(codonUsage$count[codonUsage$amino == x[1]])
})
cor<-c("red"="red",
"blue"="blue",
"orange"="orange",
"darkgreen"="darkgreen")
linha<-1
for(i in 1:5){
for(j in 1:4){
tmp$cor[linha]<-cor[j]
tmp$shape[linha]<-i
linha<-linha+1
}
}
codonUsage<-merge(codonUsage,tmp,by="amino")
codonUsage$shape<-(factor(codonUsage$shape))
lm<-lm(codonUsage$tGCN~codonUsage$count)
corr<-cor.test(codonUsage$tGCN,codonUsage$count)
maxX<-max(codonUsage$count)
maxY<-max(codonUsage$tGCN)
library(ggplot2)
g<-ggplot()+theme_bw()+
ylab("tRNA Count")+
xlab("Codon Usage")+
geom_point(data = codonUsage,
aes(y=tGCN,x=count,
color=cor,
shape=shape))+
scale_color_manual(values = cor)+
# col="red",
# pch=1)+
geom_abline(slope = lm$coefficients[2],
intercept = lm$coefficients[1],
lty=2,
col="blue")+
geom_text(aes(x=maxX*0.1, y=maxY*0.75,
label=paste("Correlation:",
round(corr$estimate,3),
"\npvalue:",
format(corr$p.value,digits = 3, scientific=T))))
g
cat("Zeros:\n")
tmp2<-t(apply(codonUsage[codonUsage$tGCN ==0,c(1,7,3,6)],
MARGIN = 1,
FUN = function(x){
if(x[2]==x[3]){
return(c(x[1],"Min"))
}else if(x[4]==x[3]){
return(c(x[1],"Max"))
}else{
return(c(x[1],"Oth"))
}
}))
table(tmp2[,2])
table(tmp2[,1])
View(tmp)
unique(tmp2[,1])
unique(tmp2[,1])%in%tmp$amino
!unique(tmp2[,1])%in%tmp$amino
!tmp$amino%in%unique(tmp2[,1])
tmp$amino[!tmp$amino%in%unique(tmp2[,1])]
tmp$amino[tmp$amino%in%unique(tmp2[,1])]
View(tmp2)
codonUsage$amino[codonUsage$amino%in%tmp$amino[!tmp$amino%in%unique(tmp2[,1])]]
table(tmp2[,2])
table(tmp2[,1])
sum(table(tmp2[,1]))
View(codonUsage)
codonUsage[codonUsage$tGCN ==0,]
nrow(codonUsage[codonUsage$tGCN ==0,])
setwd(workdir)
# deltaW<-readDeltaW(top,workdir)
# deltaW$dw<-NA
codonUsage<-read.csv("AuxFiles/dCodonUsage.csv",
header = T,
stringsAsFactors = F)
aminos<-read.csv("AuxFiles/dAminoCodon.csv",
header = T,
stringsAsFactors = F)
codonUsage<-merge(codonUsage[,c("ref","count")],
aminos,
by="ref")
tRNAe<-read.csv("TAIFiles/REL606tRNA.csv",
sep = "\t",
header = T,
stringsAsFactors = F)
tRNAe$ref<-apply(as.data.frame(tRNAe$AntiCodonsList),
MARGIN = 1,
convertToComplement)
codonUsage<-merge(codonUsage,tRNAe,by="ref")
codonUsage$ref[codonUsage$ref%in%tRNAe$ref]
codonUsage$ref[!codonUsage$ref%in%tRNAe$ref]
codonUsage$ref%in%tRNAe$ref
codonUsage$ref[!tRNAe$ref%in%codonUsage$ref]
codonUsage<-merge(codonUsage,tRNAe,by="ref",all.y = T)
setwd(workdir)
# deltaW<-readDeltaW(top,workdir)
# deltaW$dw<-NA
codonUsage<-read.csv("AuxFiles/dCodonUsage.csv",
header = T,
stringsAsFactors = F)
aminos<-read.csv("AuxFiles/dAminoCodon.csv",
header = T,
stringsAsFactors = F)
codonUsage<-merge(codonUsage[,c("ref","count")],
aminos,
by="ref")
tRNAe<-read.csv("TAIFiles/REL606tRNA.csv",
sep = "\t",
header = T,
stringsAsFactors = F)
tRNAe$ref<-apply(as.data.frame(tRNAe$AntiCodonsList),
MARGIN = 1,
convertToComplement)
codonUsage<-merge(codonUsage,tRNAe,by="ref",all.y = T)
codonUsage$ref[is.na(codonUsage$amino)]
codonUsage<-codonUsage[is.na(codonUsage$amino),]
setwd(workdir)
# deltaW<-readDeltaW(top,workdir)
# deltaW$dw<-NA
codonUsage<-read.csv("AuxFiles/dCodonUsage.csv",
header = T,
stringsAsFactors = F)
aminos<-read.csv("AuxFiles/dAminoCodon.csv",
header = T,
stringsAsFactors = F)
codonUsage<-merge(codonUsage[,c("ref","count")],
aminos,
by="ref")
tRNAe<-read.csv("TAIFiles/REL606tRNA.csv",
sep = "\t",
header = T,
stringsAsFactors = F)
tRNAe$ref<-apply(as.data.frame(tRNAe$AntiCodonsList),
MARGIN = 1,
convertToComplement)
codonUsage<-merge(codonUsage,tRNAe,by="ref",all.y = T)
codonUsage$ref[is.na(codonUsage$amino)]
codonUsage<-na.exclude(codonUsage)
codonUsage$ref[is.na(codonUsage$amino)]
setwd(workdir)
# deltaW<-readDeltaW(top,workdir)
# deltaW$dw<-NA
codonUsage<-read.csv("AuxFiles/dCodonUsage.csv",
header = T,
stringsAsFactors = F)
aminos<-read.csv("AuxFiles/dAminoCodon.csv",
header = T,
stringsAsFactors = F)
codonUsage<-merge(codonUsage[,c("ref","count")],
aminos,
by="ref")
tRNAe<-read.csv("TAIFiles/REL606tRNA.csv",
sep = "\t",
header = T,
stringsAsFactors = F)
tRNAe$ref<-apply(as.data.frame(tRNAe$AntiCodonsList),
MARGIN = 1,
convertToComplement)
codonUsage<-merge(codonUsage,tRNAe,by="ref",all.y = T)
codonUsage$ref[is.na(codonUsage$amino)]
codonUsage<-na.exclude(codonUsage)
tmp<-as.data.frame(unique(codonUsage$amino))
colnames(tmp)<-"amino"
codonUsage$ref[is.na(codonUsage$amino)]
tmp<-as.data.frame(unique(codonUsage$amino))
colnames(tmp)<-"amino"
tmp$max<-apply(tmp,MARGIN = 1,
FUN = function(x){
max(codonUsage$count[codonUsage$amino == x[1]])
})
tmp$min<-apply(as.data.frame(tmp[,1]),MARGIN = 1,
FUN = function(x){
min(codonUsage$count[codonUsage$amino == x[1]])
})
cor<-c("red"="red",
"blue"="blue",
"orange"="orange",
"darkgreen"="darkgreen")
linha<-1
for(i in 1:5){
for(j in 1:4){
tmp$cor[linha]<-cor[j]
tmp$shape[linha]<-i
linha<-linha+1
}
}
codonUsage<-merge(codonUsage,tmp,by="amino")
codonUsage$shape<-(factor(codonUsage$shape))
lm<-lm(codonUsage$tGCN~codonUsage$count)
corr<-cor.test(codonUsage$tGCN,codonUsage$count)
maxX<-max(codonUsage$count)
maxY<-max(codonUsage$tGCN)
library(ggplot2)
g<-ggplot()+theme_bw()+
ylab("tRNA Count")+
xlab("Codon Usage")+
geom_point(data = codonUsage,
aes(y=tGCN,x=count,
color=cor,
shape=shape))+
scale_color_manual(values = cor)+
# col="red",
# pch=1)+
geom_abline(slope = lm$coefficients[2],
intercept = lm$coefficients[1],
lty=2,
col="blue")+
geom_text(aes(x=maxX*0.1, y=maxY*0.75,
label=paste("Correlation:",
round(corr$estimate,3),
"\npvalue:",
format(corr$p.value,digits = 3, scientific=T))))
g
cat("Zeros:\n")
tmp2<-t(apply(codonUsage[codonUsage$tGCN ==0,c(1,7,3,6)],
MARGIN = 1,
FUN = function(x){
if(x[2]==x[3]){
return(c(x[1],"Min"))
}else if(x[4]==x[3]){
return(c(x[1],"Max"))
}else{
return(c(x[1],"Oth"))
}
}))
table(tmp2[,2])
table(tmp2[,1])
nrow(codonUsage[codonUsage$tGCN ==0,])
codonUsage$amino[codonUsage$amino%in%tmp$amino[!tmp$amino%in%unique(tmp2[,1])]]
